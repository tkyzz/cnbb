function getcity(a,b){$("#"+a).html('<option value="">请选择城市</option>');var c="";$.get("/ajax/getcity",{code:b},function(b){1==b.status&&($.each(b.msg,function(a,b){c+=$(".sx_city_code").val()==b.code||$(".hk_city_code").val()==b.code?"<option value="+b.code+" selected>"+b.name+"</option>":"<option value="+b.code+">"+b.name+"</option>"}),$("#"+a).append(c))},"json")}function explorer(){var b,a=navigator.userAgent;a.indexOf("MSIE")>=0?window.location.reload():a.indexOf("Firefox")>=0?(window.location.href=window.location.href,b=window.location.href,b=b.substring(0,b.indexOf("#")),window.location.href=b):a.indexOf("Chrome")>=0?window.location.reload():a.indexOf("Opera")>=0?window.location.href=window.location.href:a.indexOf("Safari")>=0?window.location.href=window.location.href:a.indexOf("Netscape")>=0&&(window.location.href=window.location.href)}function gertrade(a,b){var c="";$("#"+a).html(""),$.get("/ajax/gettrade",{pid:b},function(b){1==b.status&&($.each(b.info,function(a,b){c+="<option value="+b.id+">"+b.name+"</option>"}),$("#"+a).append(c))},"json")}function count_text_num(a,b){$(a).keyup(function(){var c=$(a).val();$(a).val().length>=2e3&&$(a).val(c.substring(0,2e3)),$(b).html("<span>"+c.length+"</span>/2000")})}function nunber(a){var c,d,e,f,g,h,i,b=new Array;if(b[0]="验证错误",b[1]=!1,c=new Array("验证通过!","身份证号码位数不对!","出生日期超出范围或含有非法字符!","身份证号码校验错误!","身份证地区非法!"),d={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"},i=new Array,i=a.split(""),null==d[parseInt(a.substr(0,2))])return b[0]=c[4],b[1]=!1,b;switch(a.length){case 15:return ereg=0==(parseInt(a.substr(6,2))+1900)%4||0==(parseInt(a.substr(6,2))+1900)%100&&0==(parseInt(a.substr(6,2))+1900)%4?/^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}$/:/^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}$/,ereg.test(a)?(b[0]=c[0],b[1]=!0,b):(b[0]=c[2],b[1]=!1,b);case 18:return ereg=0==parseInt(a.substr(6,4))%4||0==parseInt(a.substr(6,4))%100&&0==parseInt(a.substr(6,4))%4?/^[1-9][0-9]{5}19[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}[0-9Xx]$/:/^[1-9][0-9]{5}19[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}[0-9Xx]$/,ereg.test(a)?(g=7*(parseInt(i[0])+parseInt(i[10]))+9*(parseInt(i[1])+parseInt(i[11]))+10*(parseInt(i[2])+parseInt(i[12]))+5*(parseInt(i[3])+parseInt(i[13]))+8*(parseInt(i[4])+parseInt(i[14]))+4*(parseInt(i[5])+parseInt(i[15]))+2*(parseInt(i[6])+parseInt(i[16]))+1*parseInt(i[7])+6*parseInt(i[8])+3*parseInt(i[9]),e=g%11,h="F",f="10X98765432",h=f.substr(e,1),h==i[17]?(b[0]=c[0],b[1]=!0,b):(b[0]=c[3],b[1]=!1,b)):(b[0]=c[2],b[1]=!1,b);default:return b[0]=c[1],b[1]=!1,b}}function show_time(a){var b=1e3*parseInt($("#sendcodetime").val());time_distance=b-1e3,time_distance>=0?(int_second=Math.floor(time_distance/1e3),$(a).val(int_second+"秒后重新发送").attr("disabled","disabled"),$("#sendcodetime").val(int_second),setTimeout(function(){show_time(a)},1e3)):($(a).val("重新发送").removeAttr("disabled").removeClass("disabled"),$("#sendcodetime").val(180))}$.validator.addMethod("checkpmmust",function(){return $('[name="contacter_phone"]').val()||$('[name="contacter_mobile"]').val()?!0:!1},"座机、手机号最少填一项"),$.validator.addMethod("checkNumiso",function(a){return 0==a?!1:!0},"请选择时间"),$.validator.addMethod("checkChunNum",function(a){var c="/^[-ÿa-zA-Z.s,()（）]+$/";return c.test(a)?!0:!1},"请选择时间"),$.validator.addMethod("isEmailPhone",function(a,b){var c=/^([a-zA-Z0-9]+[_|\_|\-\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/,d=/^1\d{10}$/;return this.optional(b)||c.test(a)||d.test(a)},$.validator.format("请填写正确的邮箱或手机号")),$.validator.addMethod("checkContactTelCode",function(){return $("#telValue").val()&&!$("#telCode").val()?!1:!0},"请输入电话区号"),$.validator.addMethod("checkContactTelValue",function(){return $("#telCode").val()&&!$("#telValue").val()?!1:!0},"请输入电话号"),$.validator.addMethod("isCardNo",function(a){if(0==a.length)return!0;var d=nunber(a);return d[1]?!0:!1},"请输入正确的身份证"),$.validator.addMethod("isChEn",function(a){var c=/(^[\u4E00-\u9FA5]+$|^[a-zA-Z]+$)/;return c.test(a)?!0:!1},"只能是中文或英文"),$.validator.addMethod("isTelNo",function(a,b){var c=/^[1-9]{1}\d{7}$/;return this.optional(b)||c.test(a)},$.validator.format("电话格式不正确,7-8位数字")),$.validator.addMethod("telcode",function(a,b){var c=/^((\d{3})|(\d{4}))$/;return this.optional(b)||c.test(a)},$.validator.format("区号格式不正确")),$.validator.addMethod("isMobile",function(a,b){var c=/^1(3|4|5|7|8)\d{9}$/;return this.optional(b)||c.test(a)},$.validator.format("手机格式不正确")),$.validator.addMethod("isQQ",function(a,b){var c=/^[1-9]\d{4,9}$/;return this.optional(b)||c.test(a)},$.validator.format("QQ格式不正确")),$.validator.addMethod("isMSN",function(a,b){var c=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return this.optional(b)||c.test(a)},$.validator.format("MSN格式不正确")),$.validator.addMethod("numCheck",function(a){return 0==a.length?!0:a.match(/[^0-9]/)},"不能只输入数字"),$.validator.addMethod("userNamecheck",function(a){return 0==a.length?!0:a.match(/^([\u4e00-\u9fa5]|[a-zA-Z0-9_\(\)（）])*$/)},"请不要输入非法字符"),$(function(){function a(){$.post("/ajax/getmsgnum",{op:"get"},function(a){1==a.status&&(a.info.notice>0?($(".notice-tag").show(),$(".notice-tag").html(a.info.notice)):0==a.info.notice&&$(".notice-tag").hide(),0==a.info.deliver?$(".js_feedmsg_num").hide():$(".js_feedmsg_num").show(),0==a.info.recommend?$(".js_recommend_num").hide():$(".js_recommend_num").show())},"json")}var b,c;a(),setInterval(a,"50000"),$("body").delegate("#login","click",function(){var a=/^([a-zA-Z0-9]+[_|\_|\-\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/,b=/^1(3|4|5|7|8)\d{9}$/,d=$("#username").val(),e=$("#password").val(),f=$("#url_return").val(),g=$("#keep").attr("checked");return 0==d.length||0==e.length?(layer.msg("请输入用户名和密码！",{icon:5}),!1):a.test(d)||b.test(d)?($("#login").val("登录中...").attr("disabled",!0),$.post("login",{username:d,password:e,return_url:f,is_keep:g},function(a){1==a.status?($("#password").val("123123412341123123412341"),$("#login").val("登录成功"),window.location.href=a.url.indexOf("http://")>-1?a.url:"/index.html"):-1==a.status?(layer.msg("这里是学生用户登录页面！<br>您是企业用户，系统将自动为您跳转企业用户登录页！",{icon:6,time:3e3}),setTimeout(function(){window.location.href="/hrLogin.html"},2500),$("#login").val("登录").removeAttr("disabled")):(layer.msg(a.msg,{icon:5}),$("#login").val("登录").removeAttr("disabled"))},"json"),void 0):(layer.msg("用户名不正确！",{icon:5}),!1)}),$("body").delegate(".phonecli","click",function(){$("#is_phone").val(1),$("#mt").val("1"),$("#module2").removeAttr("disabled"),$(".js_wsqy").show()}),$("body").delegate(".emailcli","click",function(){$("#module1").attr("checked",!0),$("#mt").val("1"),$("#module2").attr("disabled",!0),$(".js_wsqy").hide(),$("#is_phone").val(0)}),$("body").delegate("#module1","click",function(){$(".invite-code").show(),$(".emailcli").show(),$("#mt").val(1)}),$("body").delegate("#module2","click",function(){$(".invite-code").hide(),$(".emailcli").hide(),$("#mt").val(2)}),$(".js_phone").keyup(function(){"重新发送"==$(".js_send_phone_code").val()&&$(".js_send_phone_code").val("获取验证码")}),b=$(".js_verifyImg"),c=b.attr("src"),b.attr("title","点击刷新"),$(".code-img").click(function(){c.indexOf("?")>0?b.attr("src",c+"&random="+Math.random()):b.attr("src",c.replace(/\?.*$/,"")+"?"+Math.random())}),$("#signup").click(function(){var a=/^1(3|4|5|7|8)\d{9}$/,b=$(".js_phone").val(),c=$("#phonepassword").val(),d=$("#inviteCode").val(),e=$("#smsCode").val();return 0==b.length?(layer.msg("请输入手机号",{icon:5}),!1):a.test(b)?0==c.length?(layer.msg("请输入密码",{icon:5}),!1):c.length<6?(layer.msg("密码至少6位",{icon:2}),!1):0==e.length?(layer.msg("请输入短信验证码",{icon:5}),!1):(d=d?d:0,$("#signup").val("注册中...").attr("disabled",!0),$.post("/register",{username:b,password:c,verify:e,mt:1,code:d},function(a){1==a.status?(0==a.is_phone&&(a.url=a.url+"?email="+a.email),$("#phonepassword").val("123123412341123123412341"),window.location.href=a.url):($("#signup").val("注册").removeAttr("disabled"),layer.msg(a.info,{icon:5}))},"json"),void 0):(layer.msg("手机格式不正确",{icon:2}),void 0)}),$(".js_send_phone_code").click(function(){var a=$(".verify_code").val(),b=/^1(3|4|5|7|8)\d{9}$/,c=$(".js_phone").val(),d=$(this).attr("data-id"),e=$(this).attr("data-type");return 0==c.length?(layer.msg("请输入手机号",{icon:5}),void 0):b.test(c)?4!=a.length?(layer.msg("请输入四位图片验证码！",{icon:5}),!1):($.post("/sendCode",{phone:c,usage:d,verify:a,type:e},function(a){1==a.status?show_time(".js_send_phone_code"):($(".code-img").click(),$(".verify_code").val(""),$(".js_send_phone_code").removeAttr("disabled"),null!=a.msg?layer.msg(a.msg,{icon:5}):layer.msg("系统出错,工程师正在抢修中……",{icon:5}))},"json"),void 0):(layer.msg("手机格式不正确",{icon:5}),void 0)}),$("#next_email").click(function(){var a=$(".js_email_reset_password").val(),b=/^([a-zA-Z0-9]+[_|\_|\-\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;return b.test(a)?($.post("mailReset",{email:a},function(b){0==b.status?($(".js_send_email").text(a),$(".input_email").hide(),$(".show_email").show()):alert(b.info)},"json"),void 0):!0}),$("#next_phone").click(function(){var a=$(".js_phone").val(),b=/^1\d{10}$/,c=$(".js_phone_reset_code").val();return $(".verify_code").val(),b.test(a)?4!=c.length?(layer.msg("请输入手机验证码",{icon:5}),!1):($.post("/checkPhonecode",{phone:a,code:c,usage:2},function(a){1==a.status?($(".input_phone").hide(),$(".js_reset_password").show()):layer.msg(a.msg,{icon:5})},"json"),void 0):(layer.msg("手机号不正确",{icon:5}),!1)}),$(".js_sub_reset_pwd").click(function(){var a=$("#type").val(),b=$(".js_phone").val(),c=$(".js_phone_reset_code").val(),d=$("#new_pwd").val();return d!=$("#t_new_pwd").val()?(layer.msg("两次密码不一致！",{icon:5}),void 0):($.post("/phoneReset",{phone:b,code:c,password:d},function(b){1==b.status?(layer.msg("修改成功！",{icon:6}),window.location.href="company"==a?"/hrLogin.html":"/login.html"):alert(b.info)},"json"),void 0)}),$(".js_change_pwd").click(function(){var a=$("#oldPassword").val(),b=$("#newPassword").val(),c=$("#surePassword").val();return 0==a.length?(layer.tips("当前密码不能为空","#oldPassword"),!1):0==b.length?(layer.tips("新密码不能为空","#newPassword"),!1):0==c.length?(layer.tips("请输入确认密码","#surePassword"),!1):b!=c?(layer.msg("两次密码不一致！",{icon:7}),!1):a==c?(layer.msg("原密码和新密码相同",{icon:7}),!1):($(".js_change_pwd").text("提交中").attr("disabled",!0),$.post("/userInfo/changePwd",{oldpassword:a,newpassword:b},function(a){1==a.status?($(".js_change_pwd").text("修改成功"),setTimeout(function(){window.location.href=a.url},500)):($(".js_change_pwd").text("保存").attr("disabled",!1),layer.msg(a.info,{icon:5}))},"json"),void 0)}),$(".sx_prov").change(function(){var a=$(".sx_prov option:selected").val(),b="sx_city";getcity(b,a)}),$(".hk_prov").change(function(){var a=$(".hk_prov option:selected").val(),b="hk_city";getcity(b,a)}),$(".js_baseinfo_edit").click(function(){var a=$(".sx_prov  option:selected").val(),b=$(".hk_prov  option:selected").val();getcity("sx_city",a),getcity("hk_city",b)}),$(".js_baseinfo_save").click(function(){$("#resumebaseForm").valid()&&$("#resumebaseForm").submit()}),$("#resumebaseForm").validate({errorLabelContainer:"#info_error",onkeyup:!1,rules:{full_name:{required:!0,isChEn:!0},mobile:{required:!0,isMobile:!0},gender:{required:!0},email:{required:!0,email:!0},birthday:{required:!0},height:{range:[100,300]},province_id:{required:!0},city_id:{required:!0},hk_type:{required:!0},hk_province_id:{required:!0},hk_city_id:{required:!0},card_type:{required:!0},card_no:{isCardNo:!0},address:{required:!0,numCheck:!0,userNamecheck:!0}},messages:{full_name:{required:"请输入姓名",isChEn:"姓名只能是中文或英文"},mobile:{required:"请填写手机号",isMobile:"请填写正确的手机号"},gender:{required:"性别必选"},email:{required:"请填写邮箱",email:"请输入正确的邮箱"},birthday:{required:"出生年月为必填"},height:{range:"身高不正确"},province_id:{required:"实习省"},city_id:{required:"实习市"},hk_type:{required:"请选择户口类型"},hk_province_id:{required:"户口省"},hk_city_id:{required:"户口市"},card_type:{required:"证件类型"},card_no:{isCardNo:"请输入正确的身份证号"},address:{required:"详细地址必填",numCheck:"地址不能为纯数字",userNamecheck:"地址不能有非法字符"}},submitHandler:function(a){$("#resumebaseForm").ajaxSubmit({url:"/ajax/updateResume",type:"POST",dataType:"json",beforeSubmit:function(){$(a).find(".js_baseinfo_save").val("提交中...").attr("disabled",!0)},success:function(b){1==b.status?($(a).find(".js_baseinfo_save").val("保存成功").removeAttr("disabled"),$(a).find('[name="id"]').val(b.res.result),$.ajax({async:!1,type:"POST",url:"/get_resumeInfo",data:{id:$(a).find('[name="resume_id"]').attr("data-id")},dataType:"json",success:function(b){if(1==b.status){$(".js_info_show").html(""),$(".js_info_show").append(b.html),$(a).find('[name="type"]').val("base_update"),$(".js_info_box").find(".js_baseinfo_save").val("保存").removeAttr("disabled"),$(".js_info_box").find(".profile-edit").hide(),$(".js_info_box").find(".profile-show").show();var c=$("a.preview").attr("data-url");$("a.preview").attr("href",c).removeAttr("onclick")}else layer.msg(b.msg,{icon:5})}})):(layer.msg(b.msg,{icon:5}),$(a).find(".js_baseinfo_save").val("保存").attr("disabled",!1))}})}}),$(".jzsx").click(function(){$("#partTimeSelection").show()}),$(".jqsx").click(function(){$("#partTimeSelection").hide()}),$("body").delegate(".stag","click",function(){var a="",b=new Array,c=$(this);$("#hint").text(""),c.is(":checked")?c.attr("checked",!0):c.removeAttr("checked"),$(".stag:checked").each(function(a){b[a]=$(this).val()}),a=b.join("|"),$('input[name="tags"]').val(a)})});